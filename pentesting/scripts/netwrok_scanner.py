#!/ur/bin/env python
from scapy.layers.l2 import ARP, Ether, srp


def scan(ip):
    arp_request = ARP(pdst=ip)
    broadcast = Ether(dst="ff:ff:ff:ff:ff:ff")
    arp_broadcast_request = broadcast/arp_request
    (valid_list, not_valid_list) = srp(arp_broadcast_request, verbose=False, timeout=10)
    network_node_list = [];
    for valid in valid_list:
        network_node_list.append({"ip": valid[1].psrc, "mac": valid[1].hwsrc})
    return network_node_list


def print_result(scan_result):
    print("IP\t\t\t\tMAC ADDR\n--------------------------------------------------")
    for node in scan_result:
        print(node["ip"] + "\t\t" + node["mac"])


scan_result = scan("192.168.0.1/24")
print_result(scan_result)
